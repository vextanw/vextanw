<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RED PRO | Lobby System</title>
    <style>
        :root { --main-red: #ff0000; --bg-black: #050000; --panel-bg: rgba(8, 0, 0, 0.98); }
        
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background-color: var(--bg-black); color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden; }

        @keyframes redToWhite { 0%, 100% { color: var(--main-red); text-shadow: 0 0 15px var(--main-red); } 50% { color: #ffffff; text-shadow: 0 0 20px rgba(255, 255, 255, 0.6); } }
        .animated-text { animation: redToWhite 3s infinite ease-in-out; }

        #bgCanvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.3; }

        nav { display: flex; justify-content: space-between; align-items: center; padding: 15px 8%; position: fixed; width: 84%; top: 0; z-index: 100; background: rgba(0,0,0,0.9); backdrop-filter: blur(15px); border-bottom: 1px solid rgba(255,0,0,0.2); }

        .btn { padding: 12px 30px; border: 1px solid var(--main-red); background: transparent; color: white; font-weight: bold; cursor: pointer; transition: 0.4s; letter-spacing: 2px; text-transform: uppercase; }
        .btn:hover { background: var(--main-red); box-shadow: 0 0 25px var(--main-red); }

        /* LOBİ PANELİ */
        #lobbyHub { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--panel-bg); z-index: 500; display: none; flex-direction: column; align-items: center; justify-content: center; backdrop-filter: blur(20px); }
        .lobby-content { width: 600px; text-align: center; }

        .lobby-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px; }
        .lobby-card { background: #111; border: 1px solid #333; padding: 20px; cursor: pointer; transition: 0.3s; }
        .lobby-card:hover { border-color: var(--main-red); }

        /* CHAT SİSTEMİ */
        #chatRoom { width: 100%; height: 100%; display: none; flex-direction: column; padding: 100px 10% 20px 10%; box-sizing: border-box; }
        #chatMessages { flex: 1; background: rgba(255,255,255,0.05); border: 1px solid #222; overflow-y: auto; padding: 20px; margin-bottom: 10px; display: flex; flex-direction: column; gap: 10px; }
        .msg { background: #1a1a1a; padding: 10px; border-radius: 5px; max-width: 70%; border-left: 3px solid var(--main-red); }
        .msg span { font-weight: bold; color: var(--main-red); display: block; font-size: 12px; }

        input { width: 100%; padding: 12px; background: #111; border: 1px solid #333; color: white; border-radius: 5px; box-sizing: border-box; margin-bottom: 10px; }
        input:focus { border-color: var(--main-red); outline: none; }

        .pp-circle { width: 35px; height: 35px; border-radius: 50%; border: 2px solid var(--main-red); overflow: hidden; background: #111; display: flex; justify-content: center; align-items: center; }
        .pp-circle img { width: 100%; height: 100%; object-fit: cover; }
    </style>
</head>
<body>

    <canvas id="bgCanvas"></canvas>

    <nav>
        <div class="logo">RED<span>PRO</span></div>
        <div style="display: flex; gap: 20px; align-items: center;">
            <span onclick="openLobbyHub()" style="cursor:pointer; font-weight:bold;" class="animated-text">OYUNCU BUL</span>
            <div id="user-info" style="display:none; display: flex; align-items: center; gap: 10px;" onclick="toggleProfile()">
                <span id="nav-username">User</span>
                <div class="pp-circle" id="nav-pp">?</div>
            </div>
        </div>
    </nav>

    <main style="height:100vh; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center;">
        <h1 class="animated-text" style="font-size: 5rem; letter-spacing: 15px;">RED HUB</h1>
        <p style="color:#444;">OYUNCULARLA BULUŞ, EKİBİNİ KUR.</p>
    </main>

    <div id="lobbyHub">
        <span onclick="closeLobbyHub()" style="position:absolute; top:40px; right:40px; font-size:30px; cursor:pointer;">✕</span>
        <div class="lobby-content" id="hubMain">
            <h1 class="animated-text">OYUNCU BULMA</h1>
            <div class="lobby-grid">
                <div class="lobby-card" onclick="showCreateLobby()">
                    <h3>LOBİ OLUŞTUR</h3>
                    <p style="font-size:12px; color:#666;">Kendi ekibini kur ve lider ol.</p>
                </div>
                <div class="lobby-card" onclick="showFindLobby()">
                    <h3>LOBİ BUL</h3>
                    <p style="font-size:12px; color:#666;">Aktif odalara katıl veya kod gir.</p>
                </div>
            </div>
        </div>

        <div class="lobby-content" id="createLobbyScreen" style="display:none;">
            <h2 class="animated-text">LOBİ OLUŞTUR</h2>
            <input type="text" id="lobbyName" placeholder="Lobi Adı: ......">
            <input type="password" id="lobbyPass" placeholder="Lobi Şifresi (isteğe bağlı)">
            <button class="btn" style="width:100%" onclick="confirmCreateLobby()">OLUŞTUR</button>
            <p onclick="backToHub()" style="cursor:pointer; margin-top:15px; color:#444;">Geri Dön</p>
        </div>

        <div class="lobby-content" id="findLobbyScreen" style="display:none;">
            <h2 class="animated-text">AKTİF LOBİLER</h2>
            <input type="text" placeholder="Davet Kodu Girin...">
            <div id="lobbyList" style="margin-top:20px;">
                </div>
            <p onclick="backToHub()" style="cursor:pointer; margin-top:15px; color:#444;">Geri Dön</p>
        </div>
    </div>

    <div id="chatRoom" style="position:fixed; top:0; left:0; width:100%; height:100%; background:var(--bg-black); z-index:1000;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <h2 id="currentLobbyTitle" class="animated-text">LOBİ</h2>
            <button class="btn" style="padding:5px 15px;" onclick="exitChat()">AYRIL</button>
        </div>
        <div id="chatMessages"></div>
        <div style="display:flex; gap:10px;">
            <input type="text" id="chatInput" placeholder="Mesajınızı yazın..." onkeypress="if(event.key==='Enter') sendMessage()">
            <button class="btn" style="padding:0 20px;" onclick="sendMessage()">GÖNDER</button>
        </div>
    </div>

    <script>
        let lobbies = [
            { name: "CS:GO Global Elite", players: 3 },
            { name: "HVH Madness", players: 1 }
        ];

        // --- PANEL KONTROLLERİ ---
        function openLobbyHub() { 
            if(localStorage.getItem('isLogged') !== 'true') return alert("Önce Giriş Yapmalısın!");
            document.getElementById('lobbyHub').style.display = 'flex'; 
        }
        function closeLobbyHub() { document.getElementById('lobbyHub').style.display = 'none'; }
        function showCreateLobby() { document.getElementById('hubMain').style.display = 'none'; document.getElementById('createLobbyScreen').style.display = 'block'; }
        function showFindLobby() { 
            document.getElementById('hubMain').style.display = 'none'; 
            document.getElementById('findLobbyScreen').style.display = 'block';
            renderLobies();
        }
        function backToHub() { 
            document.getElementById('createLobbyScreen').style.display = 'none'; 
            document.getElementById('findLobbyScreen').style.display = 'none'; 
            document.getElementById('hubMain').style.display = 'block'; 
        }

        // --- LOBİ MANTIĞI ---
        function confirmCreateLobby() {
            const name = document.getElementById('lobbyName').value;
            if(!name) return alert("Lobi adı girin!");
            lobbies.push({ name: name, players: 1 });
            enterLobby(name);
        }

        function renderLobies() {
            const list = document.getElementById('lobbyList');
            list.innerHTML = "";
            lobbies.forEach(l => {
                list.innerHTML += `
                    <div class="lobby-card" style="margin-bottom:10px; display:flex; justify-content:space-between; align-items:center;" onclick="enterLobby('${l.name}')">
                        <span>${l.name}</span>
                        <span style="font-size:12px; color:var(--main-red);">${l.players}/5 Oyuncu</span>
                    </div>
                `;
            });
        }

        function enterLobby(name) {
            document.getElementById('lobbyHub').style.display = 'none';
            document.getElementById('chatRoom').style.display = 'flex';
            document.getElementById('currentLobbyTitle').innerText = name + " CHAT";
            addMessage("Sistem", name + " lobisine katıldın. Hoş geldin!");
        }

        function exitChat() {
            document.getElementById('chatRoom').style.display = 'none';
            openLobbyHub();
        }

        // --- CHAT MANTIĞI ---
        function sendMessage() {
            const inp = document.getElementById('chatInput');
            if(!inp.value) return;
            const userName = localStorage.getItem('user') || "Bilinmeyen";
            addMessage(userName, inp.value);
            inp.value = "";
            
            // Simüle bot cevabı
            setTimeout(() => {
                addMessage("Bot_Elite", "Selam " + userName + ", maça ne zaman giriyoruz?");
            }, 1000);
        }

        function addMessage(user, text) {
            const box = document.getElementById('chatMessages');
            box.innerHTML += `
                <div class="msg">
                    <span>${user}</span>
                    ${text}
                </div>
            `;
            box.scrollTop = box.scrollHeight;
        }

        // --- DİĞER FONKSİYONLAR (Canvas & Nav) ---
        const canvas = document.getElementById('bgCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        function anim() {
            ctx.clearRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle = "rgba(255,0,0,0.2)";
            for(let i=0; i<50; i++) { ctx.fillRect(Math.random()*canvas.width, Math.random()*canvas.height, 1, 1); }
            requestAnimationFrame(anim);
        }
        anim();

        // Sayfa yüklendiğinde kullanıcıyı kontrol et
        if(localStorage.getItem('isLogged') === 'true') {
            document.getElementById('user-info').style.display = 'flex';
            document.getElementById('nav-username').innerText = localStorage.getItem('user');
            const pp = localStorage.getItem('user_pp');
            if(pp) document.getElementById('nav-pp').innerHTML = `<img src="${pp}">`;
        }
    </script>
</body>
</html>
